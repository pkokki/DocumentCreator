<h2>Download an empty mapping sheet</h2>

<p>Download an Excel workbook with the mappings definition for the template.</p>

<p>
    <mat-form-field appearance="fill" style="width:100%">
        <mat-label>Mappings name</mat-label>
        <input matInput placeholder="" [(ngModel)]="state.mappingName">
        <mat-hint>
            If the name exists the latest version for the selected template is downloaded,
            otherwise a new empty definition is prepared.
        </mat-hint>
    </mat-form-field>
</p>

<pre>{{withSources ? 'PUT' : 'GET'}} {{this.state.apiBaseUrl}}/templates/{{this.state.templateName}}/mappings/{{this.state.mappingName}}/xls</pre>

<p>
    <mat-checkbox [(ngModel)]="withSources">Check here to provide a sample source for the mapping.</mat-checkbox>
</p>

<p [hidden]="!withSources">
    <mat-form-field appearance="fill" style="width:100%">
        <mat-label>JSON payload</mat-label>
        <textarea matInput style="font-family: Roboto Mono, monospace; font-size: 80%;"
            matTextareaAutosize
            matAutosizeMinRows="8"
            matAutosizeMaxRows="10"
            [(ngModel)]="sourcePayload">
        </textarea>
    </mat-form-field>
</p>

<p>
    <button mat-stroked-button color="primary" 
        [disabled]="!state.templateName" 
        (click)="download()">
        Download Excel mappings
    </button>
</p>

